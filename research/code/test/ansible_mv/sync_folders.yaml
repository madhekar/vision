---
- name: Synchronize a list of folders to remote hosts
  hosts: qa # Replace with your inventory group or specific hosts
  become: yes # Use sudo/root privileges on the remote host if needed

  vars:
    src_root: "/Users/emadhekar/work/image_video/"
    dest_root: "/home/madhekar/temp/"
    folders_to_sync:
      - src: "{{ src_root }}/zesha_media/"
        dest: "{{ dest_root }}/"
      # - src: "{{ src_root }}/static-metadata/faces/"
      #   dest: "{{ dest_root }}/static-metadata/faces/"
      # - src: "{{ src_root }}/static-metadata/locations/"
      #   dest: "{{ dest_root }}/static-metadata/locations/"

  tasks:
      name: Synchronize folders
      ansible.posix.synchronize:
        src: "{{ item.src }}"
        dest: "{{ item.dest }}"
        mode: push # Pushing from local to remote
        delete: yes # Delete extraneous files on the remote side that are not in the local source
        recursive: yes # Recursively synchronize subdirectories
        perms: yes # Preserve permissions
        owner: yes # Preserve owner
        group: yes # Preserve group
      loop: "{{ folders_to_sync }}"