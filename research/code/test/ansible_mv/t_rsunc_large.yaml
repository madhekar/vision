- name: Transfer large image set from Linux to Mac
  hosts: all
  vars:
    source_dir: "/mnt/zmdata/home-media-app/data/app-data/vectordb"
    dest_dir: "/Users/emadhekar/tmp"
    mac_user: "emadhekar"
    mac_host: "192.168.68.107" # IP or hostname of Mac

  tasks:
    - name: Ensure rsync is installed (if necessary)
      package:
        name: rsync
        state: present
      become: false

    - name: Synchronize images to Mac
      ansible.posix.synchronize:
        src: "{{ source_dir }}"
        dest: "{{ mac_user }}@{{ mac_host }}:{{ dest_dir }}"
        mode: push
        recursive: yes
        archive: yes
        checksum: yes # Useful for verifying large files
      delegate_to: localhost # Runs rsync on the control machine
